{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/batomunkuevv/Desktop/Work/Frontend/web-exterior/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport \"@/app/globals.css\";\nimport { useState, useRef, useEffect, MouseEvent, TouchEvent } from \"react\";\n\nimport Script from \"next/script\";\nimport { ThreeScene, FloorPanel, IframePopup, KuulaEmbed } from \"@components\";\n\nimport { ApartamentType, FloorType } from \"@t\";\n\nconst Home = () => {\n    const [isLoading360, setIsLoading360] = useState(true);\n    const [showOverlayButton, setShowOverlayButton] = useState(true);\n    const [mounted, setMounted] = useState(false);\n    const [isOpenFloorPanel, setIsOpenFloorPanel] = useState(false);\n    const [selectedFloor, setSelectedFloor] = useState<FloorType | null>(null);\n    const [selectedApartament, setSelectedApartament] = useState<ApartamentType | null>(null);\n    const [tourUrl, setTourUrl] = useState<string | null>(null);\n\n    const viewerRef = useRef<HTMLDivElement>(null);\n\n    const handleCloseIframePopup = () => {\n        setTourUrl(null);\n    };\n\n    const handleOverlayClick = (e: MouseEvent | TouchEvent) => {\n        if (isLoading360) return;\n\n        e.stopPropagation();\n        e.preventDefault();\n\n        const icon = document.querySelector(\".cloudimage-360-view-360-icon\");\n\n        if (icon) {\n            icon.remove();\n        }\n\n        setShowOverlayButton(false);\n    };\n\n    const handle360Loaded = () => {\n        setIsLoading360(false);\n    };\n\n    useEffect(() => {\n        setMounted(true);\n    }, []);\n\n    useEffect(() => {\n        if (viewerRef.current && window.CI360) {\n            window.CI360.init();\n\n            const viewer = viewerRef.current;\n\n            if (viewer) {\n                const observer = new MutationObserver((mutations) => {\n                    mutations.forEach((mutation) => {\n                        if (mutation.type === \"childList\" && mutation.addedNodes.length > 0) {\n                            const cloudImage360Loader = viewer.querySelector(\".cloudimage-360-loader\");\n\n                            if (!cloudImage360Loader) {\n                                handle360Loaded();\n                                observer.disconnect();\n                            }\n                        }\n                    });\n                });\n\n                observer.observe(viewer, {\n                    childList: true,\n                    subtree: true,\n                });\n            }\n        }\n    }, [mounted]);\n\n    useEffect(() => {\n        if (selectedFloor) {\n            setShowOverlayButton(false);\n        }\n    }, [selectedFloor]);\n\n    return (\n        <>\n            <Script\n                src=\"https://scaleflex.cloudimg.io/v7/plugins/js-cloudimage-360-view/latest/js-cloudimage-360-view.min.js?func=proxy\"\n                strategy=\"beforeInteractive\"\n            />\n            <KuulaEmbed />\n            <div className=\"fixed top-[50%] left-[50%] -translate-x-1/2 -translate-y-1/2 h-[100vh] aspect-square\">\n                {mounted && (\n                    <div\n                        ref={viewerRef}\n                        className=\"cloudimage-360\"\n                        id=\"product-360\"\n                        data-folder=\"/images/360/\"\n                        data-filename-x=\"360_{index}.webp\"\n                        data-amount-x=\"59\"\n                        data-index-zero-base=\"2\"\n                    ></div>\n                )}\n                {showOverlayButton && (\n                    <button\n                        type=\"button\"\n                        aria-label=\"Открыть 360°\"\n                        className=\"absolute z-30\"\n                        style={{\n                            left: \"50%\",\n                            top: \"50%\",\n                            transform: \"translate(-50%, -50%)\",\n                            width: 100,\n                            height: 100,\n                            background: \"transparent\",\n                            border: \"none\",\n                            padding: 0,\n                            pointerEvents: \"auto\",\n                        }}\n                        onClick={handleOverlayClick}\n                        onTouchEnd={handleOverlayClick}\n                    />\n                )}\n                <ThreeScene\n                    isLoading360={isLoading360}\n                    selectedFloor={selectedFloor}\n                    setSelectedApartament={setSelectedApartament}\n                    setSelectedFloor={setSelectedFloor}\n                    setIsOpenFloorPanel={setIsOpenFloorPanel}\n                />\n            </div>\n            <FloorPanel\n                isOpenFloorPanel={isOpenFloorPanel}\n                setIsOpenFloorPanel={setIsOpenFloorPanel}\n                selectedFloor={selectedFloor}\n                setSelectedFloor={setSelectedFloor}\n                selectedApartament={selectedApartament}\n                setSelectedApartament={setSelectedApartament}\n                setTourUrl={setTourUrl}\n            />\n            <IframePopup iframeUrl={tourUrl} onClose={handleCloseIframePopup} />\n        </>\n    );\n};\n\nexport default Home;\n"],"names":[],"mappings":"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","debugId":null}}]
}